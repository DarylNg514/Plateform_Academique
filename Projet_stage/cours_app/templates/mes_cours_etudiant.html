{% extends 'index.html' %}
{% load static %}
{% block title %}Mes Cours{% endblock %}
{% block content %}
<section class="hero-wrap hero-wrap-2" style="background-image: url('{% static 'images/bg_1.jpg' %}');">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text align-items-center justify-content-center">
            <div class="col-md-9 ftco-animate text-center">
                <h1 class="mb-2 bread">Mes Cours</h1>
                <p class="breadcrumbs">
                    <span class="mr-2"><a href="{% url 'acceuil' %}">Accueil <i class="ion-ios-arrow-forward"></i></a></span>
                    <span>Mes Cours <i class="ion-ios-arrow-forward"></i></span>
                </p>
            </div>
        </div>
    </div>
</section>

<section class="ftco-section">
    <div class="container">
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
        {% if cours_liste %}
            <div class="row">
                {% for cours in cours_liste %}
                <div class="col-md-4 course ftco-animate">
                    <div class="img" style="background-image: url('{% static 'images/cours.jpeg' %}');"></div>
                    <div class="text pt-4">
                        <h3>{{ cours.sigle }}</h3>
                        <p><strong>Titre :</strong> {{ cours.titre }}</p>
                        <p><strong>Description :</strong> {{ cours.description }}</p>
                        <p><strong>Programme(s) :</strong> 
                            {% for programme in cours.programme.all %}
                                {{ programme.code_programme }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        <p><strong>Domaine(s) :</strong> 
                            {% for domaine in cours.domaine.all %}
                                {{ domaine.code_programme }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        <p><strong>Session(s) :</strong> 
                            {% for session in cours.session.all %}
                                {{ session.code_session }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        <p><strong>Professeur(s) :</strong> 
                            {% for prof in cours.attribution_set.all %}
                             {{ prof.professeur.nom }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        <div class="d-flex flex-column">
                            <a href="{% url 'liste_evaluations' cours.id %}" class="btn btn-info me-2">
                                <i class="bi bi-list-task"></i> Liste des Évaluations
                            </a>
                            <a href="{% url 'liste_documents' cours.id %}" class="btn btn-primary me-2">
                                <i class="bi bi-folder"></i> Liste des Documents
                            </a>
                            <a href="{% url 'voir_notes_etudiant' cours.id %}" class="btn btn-warning mb-2">
                                <i class="bi bi-bar-chart-line"></i> Voir les Notes
                            </a>
                            <form method="post" action="{% url 'abandonner_cours' cours.id %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger">
                                    <i class="bi bi-x-circle"></i> Abandonner ce cours
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="row">
                <div class="col-md-12 text-center">
                    <p>Vous n'êtes inscrit à aucun cours pour le moment.</p>
                </div>
            </div>
        {% endif %}
        <div class="row mt-4">
            <div class="col text-center">
                <a href="{% url 'list_cours' %}" class="btn btn-secondary btn-lg">
                    <i class="bi bi-plus-lg"></i> S'inscrire a un cours
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}
